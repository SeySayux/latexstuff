\ProvidesPackage{fancytable}

\RequirePackage[table]{xcolor}
\RequirePackage{ifthen}

\RequirePackage{array}
\RequirePackage{longtable}
\RequirePackage{tabu}
\RequirePackage{xargs}

\definecolor{lightgrey}{rgb}{0.9,0.9,0.9}
\definecolor{white}{rgb}{1,1,1}

\newcommand{\fancyrowcolors}[1] {
    \ifthenelse{\isodd{#1}} {
        \rowcolors{1}{lightgrey}{white}
    } {
        \rowcolors{1}{white}{lightgrey}
    }
}

\newcommand{\fancytabletype}{}

\newenvironment{fancytableimpl}[4]{\renewcommand{\fancytabletype}{#4}
    \fancyrowcolors{#3}\begin{\fancytabletype}[#1]{#2}}
    {\hline \hline \end{\fancytabletype}}

\newenvironment{fancytable}[3][l]{\medskip\par\noindent\hskip -1.7 ex
    \begin{fancytableimpl}{#1}{#2}{#3}{tabu}}{\end{fancytableimpl}\medskip}

\newenvironment{fancylongtable}[3][l]{
    \begin{fancytableimpl}{#1}{#2}{#3}{longtabu}}{\end{fancytableimpl}}

\newcommand{\tbh}[1]{{\cellcolor{black}\textcolor{white}{\textbf{#1}}}}
\newcommand{\teh}[1]{\tbh{$\mathbf{#1}$}}
\newcommand{\tnh}{\cellcolor{white}}

\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}

\newcolumntype{e}{>{$}c<{$}}
\newcolumntype{E}[1]{>{\centering\arraybackslash$}p{#1}<{$}}

